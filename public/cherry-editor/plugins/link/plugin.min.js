!function(){"use strict";var e,t,n,r,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=tinymce.util.Tools.resolve("tinymce.util.VK"),a=function(r){return function(t){return n=typeof(e=t),(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===r;var e,n}},u=function(e){return function(t){return typeof t===e}},l=a("string"),c=a("array"),f=function(t){return e===t},s=u("boolean"),d=u("function"),m=function(t){var e=t.getParam("link_assume_external_targets",!1);return s(e)&&e?1:!l(e)||"http"!==e&&"https"!==e?0:e},x=function(t){return t.getParam("default_link_target")},g=function(t){return t.getParam("target_list",!0)},h=function(t){return t.getParam("rel_list",[],"array")},p=function(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")},v=function(){},k=function(t){return function(){return t}},y=k(!1),b=k(!(e=null)),_=function(){return C},C=(t=function(t){return t.isNone()},{fold:function(t,e){return t()},is:y,isSome:y,isNone:b,getOr:r=function(t){return t},getOrThunk:n=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:k(null),getOrUndefined:k(undefined),or:r,orThunk:n,map:_,each:v,bind:_,exists:y,forall:b,filter:_,equals:t,equals_:t,toArray:function(){return[]},toString:k("none()")}),A=function(n){var t=k(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:b,isNone:y,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return A(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:C},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(y,function(t){return e(n,t)})}};return o},O={some:A,none:_,from:function(t){return null===t||t===undefined?C:A(t)}},w=Array.prototype.indexOf,T=Array.prototype.push,N=function(t,e){return n=t,r=e,-1<w.call(n,r);var n,r},S=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!c(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);T.apply(e,t[n])}return e},D=function(t,e){return S(function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r}(t,e))},E=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return O.none()},P=function(t,e){return t?O.some(e):O.none()},L=tinymce.util.Tools.resolve("tinymce.util.Tools"),M=function(t){return l(t.value)?t.value:""},j=function(t,i){var a=[];return L.each(t,function(t){var e,n,r,o=l((e=t).text)?e.text:l(e.title)?e.title:"";t.menu!==undefined?(n=j(t.menu,i),a.push({text:o,items:n})):(r=i(t),a.push({text:o,value:r}))}),a},q=function(e){return void 0===e&&(e=M),function(t){return O.from(t).map(function(t){return j(t,e)})}},R={sanitize:function(t){return q(M)(t)},sanitizeWith:q,createUi:function(e,n){return function(t){return{name:e,type:"listbox",label:n,items:t}}},getValue:M},$=function(){return($=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},B=Object.keys,U=Object.hasOwnProperty,I=function(t,n,r,o){return function(t,e){for(var n=B(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i)}}(t,function(t,e){(n(t,e)?r:o)(t,e)}),{}},F=function(t,e){var n,r={};return I(t,e,(n=r,function(t,e){n[e]=t}),v),r},K=function(t,e){return U.call(t,e)},z=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),V=function(t){return t&&"a"===t.nodeName.toLowerCase()},W=function(t){return V(t)&&!!J(t)},H=function(t,e){if(t.collapsed)return[];for(var n=t.cloneContents(),r=new z(n.firstChild,n),o=[],i=n.firstChild;e(i)&&o.push(i),i=r.next(););return o},G=function(t){return/^\w+:/i.test(t)},J=function(t){var e=t.getAttribute("data-mce-href");return e||t.getAttribute("href")},X=function(t,e){var n,r,o=["noopener"],i=t?t.split(/\s+/):[],a=function(t){return t.filter(function(t){return-1===L.inArray(o,t)})},u=e?0<(n=a(n=i)).length?n.concat(o):o:a(i);return 0<u.length?(r=u,L.trim(r.sort().join(" "))):""},Q=function(t,e){return e=e||t.selection.getNode(),et(e)?t.dom.select("a[href]",e)[0]:t.dom.getParent(e,"a[href]")},Y=function(t,e){var n=e?e.innerText||e.textContent:t.getContent({format:"text"});return n.replace(/\uFEFF/g,"")},Z=function(t){return 0<L.grep(t,W).length},tt=function(t){var e=t.schema.getTextInlineElements();return 0===H(t.selection.getRng(),function(t){return 1===t.nodeType&&!V(t)&&!K(e,t.nodeName.toLowerCase())}).length},et=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},nt=function(t){return e=["title","rel","class","target"],n=function(e,n){return t[n].each(function(t){e[n]=0<t.length?t:null}),e},r={href:t.href},function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}(e,function(t){r=n(r,t)}),r;var e,n,r},rt=function(t,e){var n,r,o,i=$({},e);return 0<h(t).length||!1!==p(t)||(n=X(i.rel,"_blank"===i.target),i.rel=n||null),O.from(i.target).isNone()&&!1===g(t)&&(i.target=x(t)),i.href=(r=i.href,"http"!==(o=m(t))&&"https"!==o||G(r)?r:o+"://"+r),i},ot=function(l,c,s,t){var f=t||l.selection.getNode(),d=Q(l,f),m=rt(l,nt(s));l.undoManager.transact(function(){var e,t,n,r,o,i,a,u;s.href===c.href&&c.attach(),d?(l.focus(),o=l,i=d,a=s.text,u=m,a.each(function(t){"unLinkMode"!==i.getAttribute("data-link-mode")&&(i.getAttribute("is-tapdlink")&&"normal"!==i.getAttribute("mode")?i.setAttribute("linktext",t):i.hasOwnProperty("innerText")?i.innerText=t:i.textContent=t)}),o.dom.setAttribs(i,u),"unLinkMode"===i.getAttribute("data-link-mode")||i.getAttribute("is-tapdlink")&&(o.fire("mceNormalMode"),i.removeAttribute("is-tapdlink"),i.removeAttribute("mode"),i.removeAttribute("linktext")),o.selection.select(i)):(e=l,t=f,n=s.text,r=m,et(t)?ct(e,t,r):n.fold(function(){e.execCommand("mceInsertLink",!1,r)},function(t){e.insertContent(e.dom.createHTML("a",r,e.dom.encode(t)))}))})},it=function(l){l.undoManager.transact(function(){var t,e,n,r,o,i,a,u=l.selection.getNode();et(u)?lt(l,u):(e=(t=l).dom,n=t.selection,r=n.getBookmark(),o=n.getRng().cloneRange(),i=e.getParent(o.startContainer,"a[href]",t.getBody()),a=e.getParent(o.endContainer,"a[href]",t.getBody()),i&&o.setStartBefore(i),a&&o.setEndAfter(a),n.setRng(o),t.execCommand("unlink"),n.moveToBookmark(r)),l.focus()})},at=function(t,e,n,r){var o,i,a,u,l,c,s;void 0===r&&(r=null),t.hasPlugin("rtc",!0)?t.execCommand("createlink",!1,(i=(o=n)["class"],a=o.href,u=o.rel,l=o.target,c=o.text,s=o.title,F({"class":i.getOrNull(),href:a,rel:u.getOrNull(),target:l.getOrNull(),text:c.getOrNull(),title:s.getOrNull()},function(t,e){return!1===f(t)}))):ot(t,e,n,r)},ut=function(t){t.hasPlugin("rtc",!0)?t.execCommand("unlink"):it(t)},lt=function(t,e){var n,r=t.dom.select("img",e)[0];!r||(n=t.dom.getParents(r,"a[href]",e)[0])&&(n.parentNode.insertBefore(r,n),t.dom.remove(n))},ct=function(t,e,n){var r,o=t.dom.select("img",e)[0];o&&(r=t.dom.create("a",n),o.parentNode.insertBefore(r,o),r.appendChild(o))},st=function(t){return K(e=t,n="items")&&e[n]!==undefined&&null!==e[n];var e,n},ft=function(e,t){return E(t,function(t){return st(t)?ft(e,t.items):P(t.value===e,t)})},dt=function(e,t,n,r){var o=r[t],i=0<e.length;return o!==undefined?ft(o,n).map(function(t){return{url:{value:t.value,meta:{text:i?e:t.text,attach:v}},text:i?e:t.text}}):O.none()},mt=function(t,i){var a={text:t.text,title:t.title},r=function(t){var e,n,r=(e=t.url,P(a.text.length<=0,O.from(e.meta.text).getOr(e.value))),o=(n=t.url,P(a.title.length<=0,O.from(n.meta.title).getOr("")));return r.isSome()||o.isSome()?O.some($($({},r.map(function(t){return{text:t}}).getOr({})),o.map(function(t){return{title:t}}).getOr({}))):O.none()},o=function(t,e){var n,r,o=(n=i,("link"===(r=e.name)?n.link:"anchor"===r?n.anchor:O.none()).getOr([]));return dt(a.text,e.name,o,t)};return{onChange:function(t,e){var n=e.name;return"url"===n?r(t()):N(["anchor","link"],n)?o(t(),e):(("text"===n||"title"===n)&&(a[n]=t()[n]),O.none())}}},gt=tinymce.util.Tools.resolve("tinymce.util.Delay"),ht=tinymce.util.Tools.resolve("tinymce.util.Promise"),pt=function(t){var e=t.href;return 0<e.indexOf("@")&&-1===e.indexOf("/")&&-1===e.indexOf("mailto:")?O.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return $($({},t),{href:"mailto:"+e})}}):O.none()},vt=function(a,u){return E([pt,(n=m(a),r=a.getParam("link_default_protocol","http","string"),function(t){var e=t.href;return 1===n&&!G(e)||0===n&&/^\s*www(\.|\d\.)/i.test(e)?O.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+r+":// prefix?",preprocess:function(t){return $($({},t),{href:r+"://"+e})}}):O.none()})],function(t){return t(u)}).fold(function(){return ht.resolve(u)},function(i){return new ht(function(e){var n,t,r,o;n=a,t=i.message,r=function(t){e(t?i.preprocess(u):u)},o=n.selection.getRng(),gt.setEditorTimeout(n,function(){n.windowManager.confirm(t,function(t){n.selection.setRng(o),r(t)})})})});var n,r},kt=function(t){var e=t.dom.select("a:not([href])"),n=D(e,function(t){var e=t.name||t.id;return e?[{text:e,value:"#"+e}]:[]});return 0<n.length?O.some([{text:"None",value:""}].concat(n)):O.none()},yt=function(t){var e=t.getParam("link_class_list",[],"array");return 0<e.length?R.sanitize(e):O.none()},xt=tinymce.util.Tools.resolve("tinymce.util.XHR"),bt=function(e){var n=function(t){return e.convertURL(t.value||t.url,"href")},t=e.getParam("link_list");return new ht(function(e){l(t)?xt.send({url:t,success:function(t){return e(function(t){try{return O.some(JSON.parse(t))}catch(e){return O.none()}}(t))},error:function(t){return e(O.none())}}):d(t)?t(function(t){return e(O.some(t))}):e(O.from(t))}).then(function(t){return t.bind(R.sanitizeWith(n)).map(function(t){if(0<t.length){return[{text:"None",value:""}].concat(t)}return t})})},_t=function(t,e){var n=h(t);if(0<n.length){var r=e.is("_blank");return(!1===p(t)?R.sanitizeWith(function(t){return X(R.getValue(t),r)}):R.sanitize)(n)}return O.none()},Ct=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],At=function(t){var e=g(t);return c(e)?R.sanitize(e).orThunk(function(){return O.some(Ct)}):!1===e?O.none():O.some(Ct)},Ot=function(t,e,n){var r=t.getAttrib(e,n);return null!==r&&0<r.length?O.some(r):O.none()},wt=function(s,f){return bt(s).then(function(t){var e,n,r,o,i,a,u,l,c=(n=f,r=(e=s).dom,o=tt(e)?O.some(Y(e.selection,n)):O.none(),i=n?O.some(r.getAttrib(n,"href")):O.none(),a=n?O.from(r.getAttrib(n,"target")):O.none(),u=Ot(r,n,"rel"),l=Ot(r,n,"class"),{url:i,text:o,title:Ot(r,n,"title"),target:a,rel:u,linkClass:l});return{anchor:c,catalogs:{targets:At(s),rels:_t(s,c.target),classes:yt(s),anchor:kt(s),link:t},optNode:O.from(f),flags:{titleEnabled:s.getParam("link_title",!0,"boolean")}}})},Tt={dialogClass:"cherry-link-dialog",created:!1,defaultData:{href:"http://",text:"",title:"",target:""},configs:{},template:'\n    <div class="cherry-dialog">\n      <div class="cherry-dialog__content" style="width: 500px;">\n        <div class="cherry-dialog__head clearfix">\n          <span class="cherry-dialog__head-title">\u94fe\u63a5</span>\n          <span class="cherry-dialog__head-close ico-dialog-close j-close"></span>\n        </div>\n        <div class="cherry-dialog__body">\n          <form class="link-form">\n            <div class="link-form-item">\n              <p class="link-form-item__label">\u5730\u5740</p>\n              <div class="link-form-item__input">\n                <input class="form-item__href" name="href" type="text"/>\n              </div>\n            </div>\n            <div class="link-form-item j-form-item__text-container">\n              <p class="link-form-item__label">\u663e\u793a\u6587\u5b57</p>\n              <div class="link-form-item__input">\n                <input class="form-item__text" name="text"  type="text"/>\n              </div>\n            </div>\n            <div class="link-form-item">\n              <p class="link-form-item__label">\u6807\u9898</p>\n              <div class="link-form-item__input">\n                <input class="form-item__title" name="title"  type="text"/>\n              </div>\n            </div>\n            <div class="link-form-item">\n              <p class="link-form-item__label">\u94fe\u63a5\u6253\u5f00\u65b9\u5f0f</p>\n              <div class="link-form-item__input">\n                <select class="form-item__target" name="target">\n                  <option value="">\u5f53\u524d\u7a97\u53e3\u6253\u5f00</option>\n                  <option value="_blank">\u5728\u65b0\u7a97\u53e3\u6253\u5f00</option>\n                </select>\n              </div>\n            </div>\n          </form>\n        </div>\n        <div class="cherry-dialog__foot">\n          <div class="cherry-dialog__foot-btns">\n            <span class="foot-btn foot-btn__ensure j-ensure">\u786e\u5b9a</span>\n            <span class="foot-btn foot-btn__cancel j-cancel">\u53d6\u6d88</span>\n          </div>\n        </div>\n    </div>\n  </div>',create:function(){if(this.created||document.querySelector("."+this.dialogClass))return this.created=!0,void this.bindEvent();this.created=!0;var t=document.createElement("div");t.setAttribute("class","cherry-dialog-wrap "+this.dialogClass),t.innerHTML=this.template,document.querySelector("body").appendChild(t),this.bindEvent(),this.handleFocus=this.handleFocus.bind(this)},handleFocus:function(){this.$(".form-item__href").select()},show:function(t,e){var n=this;void 0===t&&(t={}),this.create(),this.$(".form-item__href").addEventListener("focus",this.handleFocus),setTimeout(function(){n.$(".form-item__href").focus()},0),document.querySelector("."+this.dialogClass).style.display="block",this.applyData(t),(this.configs=e).noText?this.$(".j-form-item__text-container").style.display="none":this.$(".j-form-item__text-container").style.display="block"},hide:function(){document.querySelector("."+this.dialogClass).style.display="none",this.$(".form-item__href").removeEventListener("focus",this.handleFocus)},bindEvent:function(){this.$(".j-ensure").removeEventListener("click",Nt.sure),this.$(".j-ensure").addEventListener("click",Nt.sure),this.$(".j-cancel").removeEventListener("click",Nt.cancel),this.$(".j-cancel").addEventListener("click",Nt.cancel),this.$(".j-close").removeEventListener("click",Nt.cancel),this.$(".j-close").addEventListener("click",Nt.cancel)},onEnsure:function(){var t=this.configs.submit;t&&!t()||this.hide()},onCancel:function(){this.hide()},$:function(t){return document.querySelector("."+this.dialogClass+" "+t)},applyData:function(t){var e=this,n=Object.assign({},this.defaultData,t);n.href||(n.href=this.defaultData.href),Object.keys(n).forEach(function(t){e.$(".form-item__"+t).value=n[t]})},getData:function(){var n=this,r={};return Object.keys(this.defaultData).forEach(function(t){var e=n.$(".form-item__"+t);r[t]=e.value}),r}},Nt={sure:function(){St.editor.fire("showDialogTitle"),Tt.onEnsure()},cancel:function(){St.editor.fire("showDialogTitle"),Tt.onCancel()}},St={noText:!1,data:{},editor:null,show:function(t,e){var n=this,r=t.initialData,o=r.text,i=r.title,a=r.target,u=r.link;this.data=t.initialData,this.editor=e,this.noText="text"!==t.body.items[1].name,Tt.show({text:o,title:i,target:a,href:u},{noText:this.noText,submit:function(){return!!e.getParam("before_insert_link",function(){return!0})(Tt.getData(),e)&&(t.onSubmit(n),!0)}})},getData:function(){var t=Tt.getData(),e=t.text,n=t.title,r=t.target,o=t.href;return this.noText?{target:r,title:n,url:{value:o,meta:{attach:undefined,text:o}}}:(this.data.text=e,this.data.title=n,this.data.target=r,this.data.url.value=o,this.data)},close:function(){Tt.hide()}},Dt=function(y){var t,e;(e=Q(t=y),wt(t,e)).then(function(t){var i,a,u,e,n,r,o,l,c,s,f,d,m,g,h,p,v=y.selection.getNode(),k=(u=v,function(t){var n=t.getData();if(!n.url.value)return ut(i),void t.close();var e=function(e){return O.from(n[e]).filter(function(t){return!a.anchor[e].is(t)})},r={href:n.url.value,text:e("text"),target:e("target"),rel:e("rel"),"class":e("linkClass"),title:e("title")},o={href:n.url.value,attach:n.url.meta!==undefined&&n.url.meta.attach?n.url.meta.attach:function(){}};vt(i,r).then(function(t){at(i,o,t,u)}),t.close()});return n=k,r=i=y,f=(e=a=t).anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),d=e.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],m=O.from(x(r)),o=m,l=r,c=e.anchor,g={url:{value:s=c.url.getOr(""),meta:{original:{value:s}}},text:l.selection.getNode().getAttribute("linktext")||c.text.getOr(""),title:c.title.getOr(""),anchor:s,link:s,rel:c.rel.getOr(""),target:c.target.or(o).getOr(""),linkClass:c.linkClass.getOr("")},h=e.catalogs,p=mt(g,h),{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:S([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],f,d,function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e}([h.anchor.map(R.createUi("anchor","Anchors")),h.rels.map(R.createUi("rel","Rel")),h.targets.map(R.createUi("target","Open link in...")),h.link.map(R.createUi("link","Link list")),h.classes.map(R.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:g,onChange:function(e,t){var n=t.name;p.onChange(e.getData,{name:n}).each(function(t){e.setData(t)})},onSubmit:n}}).then(function(t){St.show(t,y)})},Et=function(t){var e=document.createElement("a");e.target="_blank",e.href=t,e.rel="noreferrer noopener";var n,r,o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n=e,r=o,document.body.appendChild(n),n.dispatchEvent(r),document.body.removeChild(n)},Pt=function(t,e){return t.dom.getParent(e,"a[href]")},Lt=function(t){return Pt(t,t.selection.getStart())},Mt=function(t,e){var n,r;e&&(n=J(e),/^#/.test(n)?(r=t.$(n)).length&&t.selection.scrollIntoView(r[0],!0):Et(e.href))},jt=function(t){return function(){Dt(t)}},qt=function(t){return function(){Mt(t,Lt(t))}},Rt=function(r){r.on("click",function(t){var e=Pt(r,t.target);e&&i.metaKeyPressed(t)&&(t.preventDefault(),Mt(r,e))}),r.on("keydown",function(t){var e,n=Lt(r);n&&13===t.keyCode&&(!0===(e=t).altKey&&!1===e.shiftKey&&!1===e.ctrlKey&&!1===e.metaKey)&&(t.preventDefault(),Mt(r,n))})},$t=function(t,e){return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}},Bt=function(e){return function(t){return $t(e,function(){t.setActive(!e.mode.isReadOnly()&&null!==Q(e,e.selection.getNode()))})}},Ut=function(n){return function(t){var e=function(){return t.setDisabled(null===Q(n,n.selection.getNode()))};return e(),$t(n,e)}},It=function(r){return function(e){var n=function(t){return Z(t)||(e=r.selection.getRng(),0<H(e,W).length);var e},t=r.dom.getParents(r.selection.getStart());return e.setDisabled(!n(t)),$t(r,function(t){return e.setDisabled(!n(t.parents))})}},Ft=function(n){var r,e;n.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:jt(n),onSetup:Bt(n)}),n.ui.registry.addButton("openlink",{icon:"ch-open-link",tooltip:"Open link",onAction:qt(n),onSetup:Ut(n)}),n.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return ut(n)},onSetup:It(n)}),n.ui.registry.addToggleButton("cardlink",{tooltip:"Card Mode",onAction:function(){document.querySelector(".tox-pop").remove(),n.fire("mceCardMode")},icon:"card-mode",onSetup:function(t){var e=n.selection.getNode();return t.setActive("card"===e.getAttribute("mode")),function(){}}}),n.ui.registry.addToggleButton("insidelink",{tooltip:"Inside Mode",onAction:function(){document.querySelector(".tox-pop").remove(),n.fire("mceInsideMode")},icon:"insert-mode",onSetup:function(t){var e=n.selection.getNode();return t.setActive("insert"===e.getAttribute("mode")),function(){}}}),n.ui.registry.addToggleButton("normallink",{tooltip:"Normal Mode",onAction:function(){n.selection.getNode().click(),n.fire("mceNormalMode"),document.querySelector(".tox-pop").remove()},icon:"normal-link",onSetup:function(t){var e=n.selection.getNode();return t.setActive("normal"===e.getAttribute("mode")),function(){}}}),n.ui.registry.addButton("copylink",{tooltip:"Copy Link",onAction:(r=n,function(){var t=Lt(r).href,e=document.createElement("input");e.value=t,document.body.append(e),e.select(),document.execCommand("Copy"),document.body.removeChild(e),null!==t&&r.fire("linkCopySuccess")}),icon:"copy-link"}),n.ui.registry.addButton("deletelink",{tooltip:"Delete Link",icon:"link-remove",onAction:(e=n,function(){var t=Lt(e);e.dom.remove(t),e.editorContainer.querySelectorAll(".tox-silver-sink")[0].remove(),e.fire("linkDelectSuccess")})})};o.add("link",function(t){var e,n,i,r,o,a,u,l;Ft(t),(e=t).ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:qt(e),onSetup:Ut(e)}),e.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:jt(e)}),e.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return ut(e)},onSetup:It(e)}),(n=t).ui.registry.addContextMenu("link",{update:function(t){return Z(n.dom.getParents(t,"a"))?"link unlink openlink":"link"}}),r=function(t){var e=i.selection.getNode();return t.setDisabled(!Q(i,e)),function(){}},(i=t).ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Bt(i)},label:"Link",predicate:function(t){return!!Q(i,t)&&i.getParam("link_context_toolbar",!1,"boolean")},initValue:function(){var t=Q(i);return t?J(t):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var e=i.selection.getNode();return t.setActive(!!Q(i,e)),Bt(i)(t)},onAction:function(t){var e,n,r=Q(i),o=t.getValue();r?i.undoManager.transact(function(){i.dom.setAttrib(r,"href",o),i.selection.collapse(!1),t.hide()}):(e={href:o,attach:function(){}},n=tt(i)?O.some(Y(i.selection,r)).filter(function(t){return 0<t.length}).or(O.from(o)):O.none(),at(i,e,{href:o,text:n,title:O.none(),rel:O.none(),target:O.none(),"class":O.none()}),t.hide())}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:r,onAction:function(t){ut(i),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:r,onAction:function(t){qt(i)(),t.hide()}}]}),a=(o=t).getParam("link_toolbar","cardlink normallink insidelink | deletelink copylink openlink"),o.ui.registry.addContextToolbar("link",{items:a,predicate:function(t){return W(t)&&!1},position:"node",scope:"node"}),Rt(t),(u=t).addCommand("mceLink",function(){u.getParam("link_quicklink",!1,"boolean")?u.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):jt(u)()}),u.addCommand("mceCardMode",function(){u.fire("drawCardLink")}),(l=t).addShortcut("Meta+K","",function(){l.execCommand("mceLink")}),t.ui.registry.addPopover("link",{predicate:function(t){return W(t)&&!1},position:"node",scope:"node",matchClass:["show-popover"]})})}();