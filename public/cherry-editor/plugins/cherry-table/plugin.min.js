!function(){"use strict";function e(v){var g,b,x,C,y=10,s=function(){var e=v.editorContainer.getElementsByClassName("tox-collection--list");e.length&&(e[0].parentNode.removeChild(e[0]),g=b=C=0,x=null)};var h=0,E=0,t=function(e,t){if(void 0===t&&(t=!1),v.editorContainer&&document.body.contains(v.editorContainer)&&v.editorContainer.getElementsByClassName("tox-collection--list").length&&b&&g){var n=v.editorContainer,o=e.target;if(o&&!t){for(var i=void 0,r=0,a=void 0,l=0,i=o.offsetLeft,s=o.offsetParent;s;)s==n&&(r=i),i+=s.offsetLeft,s=s.offsetParent;for(a=o.getBoundingClientRect().top,s=o.offsetParent;s;)s==n&&(l=a,a+=s.getBoundingClientRect().top),s=s.offsetParent;E=a-l,h=i-r}u=t?(d=Math.ceil((e.clientX-b+5+parseInt(window.getComputedStyle(document.body,null).marginLeft.replace("px","")))/17),Math.ceil((e.clientY-g+10)/17)):(d=Math.ceil((e.clientX-h-b+5+parseInt(window.getComputedStyle(document.body,null).marginLeft.replace("px","")))/17),Math.ceil((e.clientY-E-g+10)/17));var d,c=0<(d=20<=d?20:d)?d:0,f=0<(u=20<=u?20:u)?u:0,u=y<=u?u:y;C=17*(d=y<=d?d:y);var m=v.editorContainer.getElementsByClassName("tox-insert-table-picker");m.length&&(m[0].style.width=C+"px");var p=L(d,u,c,f);(x=x||v.editorContainer.getElementsByClassName("tox-insert-table-picker")[0])&&(x.innerHTML=p)}};document.addEventListener("mousemove",t),v.on("destroy",function(){document.removeEventListener("mousemove",t)});var L=function(e,t,n,o){var i="";o&&n||(n=o=0);for(var r=0;r<e*t;r++)(r+1)%e<=n&&(n===e||(r+1)%e!=0)&&Math.ceil((r+1)/e)<=o?i+='<div role="button" style="border-width: 0 0 1px 1px;" class="tox-insert-table-picker__selected" tabindex="-1"></div>':i+='<div role="button" style="border-width: 0 0 1px 1px;" tabindex="-1"></div>';return i+='<span class="tox-insert-table-picker__label" row="'+n+'" col="'+o+'">'+n+"\xd7"+o+"</span>"};v.ui.registry.addButton("ch-table",{tooltip:"Table",icon:"table-cell",onAction:function(e,t){var n,o,i=t&&t.event?t.event.target.dom:null;i&&(n=i.getBoundingClientRect(),o=v.editorContainer.getBoundingClientRect(),b=n.left-o.left,g=n.top+n.height-o.top+4);var r,a=L(y,y,0,0);C=170,(r=v.editorContainer.getElementsByClassName("tox-sidebar-wrap")[0].offsetWidth)<b+340&&(b=r-340);var l='<div role="menu" class="tox-menu tox-collection tox-collection--list" style="position: absolute; left: '+b+"px; top: "+g+'px; overflow: hidden auto!important;z-index: 2000;">\n                 <div class="tox-collection__group">\n                     <div class="tox-fancymenuitem tox-menu-nav__js">\n                         <div class="tox-insert-table-picker" style="width: '+C+'px">\n                            '+a+"\n                         </div>\n                     </div>\n                 </div>\n            </div>";v.editorContainer.appendChild((new DOMParser).parseFromString(l,"text/html").getElementsByClassName("tox-collection--list")[0]),v.editorContainer.getElementsByClassName("tox-insert-table-picker")[0].addEventListener("mouseup",function(e){var t,n,o,i,r,a;"DIV"===e.target.nodeName&&(t=e.target.parentNode.lastElementChild,n=parseInt(t.getAttribute("row")),o=parseInt(t.getAttribute("col")),n&&o&&((i=v.plugins.table.insertTable(n,o)).setAttribute("cellpadding",8),i.style.setProperty("width","75%"),i.style.setProperty("background-color","#FFFFFF"),i.style.setProperty("border-color","#CED4D9"),i.setAttribute("border","2"),(r=document.createElement("p")).innerHTML="&nbsp;",(a=document.createElement("div")).classList.add("tox-clear-float"),a.innerHTML=i.outerHTML,v.dom.insertAfter(r,i),v.dom.insertAfter(a,i),i.remove()),s())})},onSetup:function(){var i;(i=v).editorContainer.getElementsByClassName("tox-editor-header")[0].addEventListener("click",function(e){s();var t=i.editorContainer,n=e.target.closest(".tox-tbtn");if(n){b=n.offsetLeft;for(var o=n.offsetParent;o!==t&&n!==t;)b+=o.offsetLeft,o=o.offsetParent;for(g=n.offsetTop,o=n.offsetParent;o!==t&&n!==t;)g+=o.offsetTop+o.clientTop,o=o.offsetParent;g+=n.getBoundingClientRect().height}}),i.on("click",function(){s()}),i.on("mousemove",function(e){t(e,!0)})}})}tinymce.util.Tools.resolve("tinymce.PluginManager").add("cherry-table",e)}();